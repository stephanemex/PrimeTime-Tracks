<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrimeTime Tracks</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="header-container">
            <img src="Logo_PrimeTimeTracks.png" alt="Logo PrimeTime Tracks" class="logo">
        </div>
    </header>

    <div class="container">

        <!-- Section de gestion des correspondances -->
        <div class="Explorer">
            <h2>Paramètres du projet</h2>
        </div>
        <div id="mapping-section">
            <h3>Ajouter un projet</h3>
            
            <!-- Champ pour le nom du journaliste ou producteur -->
            <input type="text" id="producer-name" placeholder="Journaliste/Producteur" />
        
            <!-- Champ pour sélectionner l'émission -->
            <select id="show-name">
                <option value="" disabled selected>Choisissez une émission</option>
                <option value="3D Eco">3D Eco</option>
                <option value="Bienvenue Chez Vous">Bienvenue Chez Vous</option>
                <option value="Ca bouge à la maison">Ca bouge à la maison</option>
                <option value="Cosmopolis">Cosmopolis</option>
                <option value="Cult.">Cult.</option>
                <option value="Demain">Demain</option>
                <option value="Décadrage">Décadrage</option>
                <option value="En Liberté">En Liberté</option>
                <option value="Ensemble">Ensemble</option>
                <option value="Esprit Solidaire">Esprit Solidaire</option>
                <option value="Genève Grandeur Nature">Genève Grandeur Nature</option>
                <option value="Go Solutions Durables">Go Solutions Durables</option>
                <option value="Immersion">Immersion</option>
                <option value="Le Journal">Le Journal</option>
                <option value="Le Monde de Demain">Le Monde de Demain</option>
                <option value="Le PoinG">Le PoinG</option>
                <option value="Les Mardis de l'Immobilier">Les Mardis de l'Immobilier</option>
                <option value="Les Sports">Les Sports</option>
                <option value="Objectif Terre">Objectif Terre</option>
                <option value="Sport Passion">Sport Passion</option>
            </select>
            
            <!-- Champ Sujet (anciennement Nom du projet) -->
            <input type="text" id="project-name" placeholder="Sujet" />
        
            <!-- Nombre de diffusions -->
            <input type="number" id="broadcast-count" placeholder="Nombre de diffusions" />
        
            <!-- Champ pour la date du projet -->
            <input type="date" id="project-date" placeholder="Date de première diffusion" />

            <!-- Import de fichiers CSV -->
            <div class="input-group">
                <label for="input-csv">Importer des fichiers CSV :</label>
                <input type="file" id="input-csv" accept=".csv" multiple style="display: none;">
                <button id="btn-upload-csv" class="btn">Ajouter des fichiers CSV</button>
            </div>
            
            <button id="add-mapping-btn">Ajouter</button>
            
            <h3>Correspondances actuelles</h3>
            <ul id="mapping-list"></ul>
        </div>
      
        <!-- Section de chargement du projet -->
        <div class="Explorer">
            <h2>Charger le projet</h2>
        </div>


        <!-- Interrupteur pour sélectionner le type de fichier -->
        <div class="file-type-switch">
            <span>Importer :</span>
            <!-- Conteneur pour le switch -->
            <label class="switch">
                <input type="checkbox" id="file-type-toggle">
                <span class="slider"></span>
            </label>
            <!-- Icônes en dehors de l'interrupteur -->
            <img id="fcpx-icon" src="img/FCPX-Logo.png" alt="FCPXML" class="file-icon visible">
            <img id="xmp-icon" src="img/adobe-premiere-pro-logo.png" alt="XMP" class="file-icon hidden">
        </div>

        <!-- Chargement des fichiers -->
        <div class="input-group">
            <input 
                type="file" 
                id="input-files" 
                multiple 
                accept=".xml,.fcpxml,.fcpxmld" 
            />
            <label class="file-upload-label" for="input-files">Sélectionner les fichiers XML</label>
        </div>

        <!-- Bouton d'extraction pour les fichiers .fcpxmld -->
        <button id="extract-btn" style="display: none;">Extraire le fichier .fcpxml</button>


        <!-- Bouton de génération de l'aperçu -->
        <button id="process-btn">Générer l'aperçu</button>

        <!-- Section d'aperçu du projet -->
        <div class="Explorer">
            <h2>Aperçu du Projet</h2>
        </div>
        <div id="preview" class="preview-container"></div>
        
        <!-- Bouton de téléchargement -->
        <button id="download-btn" style="display: none;">Télécharger le fichier Excel</button>

        <!-- Message d'information -->
        <div id="message" class="message"></div>

        <button id="to-report-btn">Accéder au Rapport</button>

        <script>
            document.getElementById('to-report-btn').addEventListener('click', function() {
                window.location.href = 'rapport.html';
            });
        </script>

    </div>

    <footer>
        <img class="footer" src="Logo_PrimeTimeTracks.png">
        <span>Développé par Stéphane Mex. Tous droits réservés © 2024</span>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <!--<script src="app.js"></script>-->
    <script src="globals.js"></script>
    <script src="projectManager.js"></script>
    <script src="fileProcessor.js"></script>
    <script src="processXmp.js"></script>
    <script src="preview-and-excel.js"></script>
</body>
</html>
